function [w_k,current_kp,adversary_kp] = SIS(N_s,workspace,goal,current,adversary,ykp,error)

current_kp = [];
adversary_kp = [];
outcomes_kp = [];
for i = 1:N_s
    %Sample x_k+1
    [c,a,o] = runMCSimsPF(workspace,current,goal,adversary,1,error,Inf);

    
    outcomes(i) = o;
    current_kp(i,:) = c(2,:);
    adversary_kp(i,:) = a(2,:);
    
    if outcomes(i) == 1
        outcomes_kp(i) = outcomes(i)*mvnpdf([current_kp(i,:),adversary_kp(i,:)],ykp(:)',eye(4));
    else
        
end
t = sum(outcomes_kp);
wkp = outcomes_kp./(t);
w_k = outcomes_kp;
    
end

